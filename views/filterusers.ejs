<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FilterUsers</title>
    <link href="/css/hover.css" rel="stylesheet" type=" text/css">
    <link href="/css/style.css" rel="stylesheet" type=" text/css">
    <link rel="icon" type="image" href="/images/favicon.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.css">
    <link href="https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.css" rel="stylesheet">
  </head>
  <body>

    <%-include('./layout/adminnavbar')%> 

    <br><br>
    <div class="container">
    <form method="POST" action="/admin/filterusers">
      <h1 class="text-center">Filter Out</h1>
      <div class="row justify-content-around">
        <div class="col-md-4 >
          
          <label for="exampleFormControlInput1">Min. Cgpa</label>
          <input type="text" class="form-control" id="exampleFormControlInput1" placeholder="7.0" name="cgpa">
        </div>
        <div class="col-md-4 >
          <label for="exampleFormControlInput11">Backlogs</label>
          <input type="text" class="form-control" id="exampleFormControlInput11" placeholder="0" name="backlog">
        </div>
      </div>
<br>
      <div class="row justify-content-around">
        <div class="col-md-4 >
          
          <label for="exampleFormControlInput111">10 %</label>
          <input type="text" class="form-control" id="exampleFormControlInput111" placeholder="10 %" name="tenthpercetage">
        </div>
        <div class="col-md-4 >
          <label for="exampleFormControlInput10">12 %</label>
          <input type="text" class="form-control" id="exampleFormControlInput10" placeholder="0" name="twelvepercentage">
        </div>
      </div>
      <br>
      <div class="text-center"> 
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="CS" name="branches">
            <label class="form-check-label" for="inlineCheckbox1"  >CS</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="IT" name="branches">
            <label class="form-check-label" for="inlineCheckbox2">IT</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox3" value="Mech" name="branches">
            <label class="form-check-label" for="inlineCheckbox3">Mech</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox4" value="EL" name="branches">
            <label class="form-check-label" for="inlineCheckbox4">EL</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox5" value="ECE" name="branches">
            <label class="form-check-label" for="inlineCheckbox5">ECE</label>
          </div>
    
        </div> 
      
      <br>
      <input type="hidden" value="<%=csrfToken%>" name="_csrf">

<div class="text-center">
  <button class="btn btn-danger"> Filter Out</button>

</div>

    </form>
  </div> 

    
<br><br>
<% if(filter){%>


<div class="container">
  <div id="toolbar" class="select">
    <select class="form-control">
      <option value="">Export Basic</option>
      <option value="all">Export All</option>
      <option value="selected">Export Selected</option>
    </select>
  </div>

<table  id="table"
   data-show-toggle="true"
   data-toggle="table"
   data-pagination="true"  //forpagination 
   data-search="true" //forsearch
   data-seacrh-align="left" 
   data-show-columns="true" 
   data-show-columns-toggle-all="true"
   data-show-refresh="true"
   data-show-fullscreen="true"
   data-show-pagination-switch="true"
   data-pagination-pre-text="Previous"
   data-pagination-next-text="Next"
   data-pagination-h-align="left"
   data-pagination-detail-h-align="right"
   data-page-list="[10,20,30,40,50,All]"    
   data-filter-control="true"
   data-show-search-clear-button="true"
   data-advanced-search="true"
  data-id-table="advancedTable"
  data-toolbar="#toolbar"
  data-show-print="true"  
  data-show-export="true"
  data-click-to-select="true" 
>
  <thead style="color: blue;">

    
    <tr>
      <th data-field="state" data-checkbox="true" data-visible="true" ></th>
      <th data-visible="false"></th>
      <th data-visible="false"></th> 
      <th data-visible="false"></th>
      <th data-field="id">#</th>

      <th data-field="name" data-filter-control="input" data-sortable="true"> Name</th>
      <th data-field="emailaddress" data-filter-control="input" data-sortable="true">Email</th>
      <th data-field="rollno"  data-visible="true" data-filter-control="input" data-sortable="true">Roll No</th>
      <th data-field="gender"  data-visible="true" data-filter-control="select" data-sortable="true">Gender </th>
      <th data-field="branch"  data-visible="true" data-filter-control="select" data-sortable="true">Branch </th>
      <th data-field="contact"  data-visible="true" data-filter-control="input" data-sortable="true">Contact </th>
      <th data-field="view"  data-visible="true"  >View  </th>


    </tr>
    
  </thead>
  <tbody>
    <% var i=0%>
    <%users.forEach(user=>{ i+=1;%>
      <tr>
        <td ></td>
        <td ></td>
        <td ></td>
        <td ></td>

        <td id="whiteindark"> <%=i%></td>
        <td id="whiteindark"><%=user.name%></td>
        <td id="whiteindark"><%=user.email%></td>
        <td id="whiteindark"><%=user.rollno%></td>
        <td id="whiteindark"><%=user.gender%></td>
        <td id="whiteindark"><%=user.branch%></td>
        <td id="whiteindark"><%=user.contact%></td>

        <td id="whiteindark"><a href="/admin/profile/<%=user._id%>" class="btn-sm btn-primary">Visit</a></td>
      </tr>
   <% })%>
  </tbody>
</table>
<% maillist=[]%>
<% users.forEach(user=>maillist.push(user.email))%>

<!-- Button trigger modal -->
<button type="button" class="btn btn-secondary " data-toggle="modal" data-target="#exampleModal000">
  Send Email
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal000" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Mail To Filtered Users</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="/admin/sendmail" method="POST" enctype="multipart/form-data">
          <input type="hidden" value="<%=csrfToken%>" name="_csrf">

          <input type="hidden" value="<%=maillist%>" name="maillist">
          <label for='subject'>Enter Subject</label>
          <input type="text" id="subject" placeholder="Enter Subject" name="mailsubject" class="form-control"><br>
          <label for="textarea">Enter Text</label>
          <textarea  id="textarea" placeholder="Enter Text" name="mailtext" class="form-control"></textarea> <br>
          <label for="attachment">Any ATtachMent</label>
          <input type="file" id="attachment" name="attachment" class="form-control">
        
       
      </div>
      <div class="modal-footer">
        
        <button  class="btn btn-primary">Send Mail</button>
      </div>
    </form>
    </div>
  </div>
</div>



<%}%>

</form>
</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/tableexport.jquery.plugin/tableExport.min.js"></script>
    <script src="https://unpkg.com/tableexport.jquery.plugin/libs/jsPDF/jspdf.min.js"></script>
    <script src="https://unpkg.com/tableexport.jquery.plugin/libs/jsPDF-AutoTable/jspdf.plugin.autotable.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.18.0/dist/extensions/export/bootstrap-table-export.min.js"></script> 
    <script src="https://unpkg.com/bootstrap-table@1.18.0/dist/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.18.0/dist/extensions/toolbar/bootstrap-table-toolbar.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.18.0/dist/extensions/print/bootstrap-table-print.min.js"></script>
    <script src="/app.js"></script>

    <script>
      $(function() {
      $('#table').bootstrapTable()
    })

    var $table = $('#table')

$(function() {
  $('#toolbar').find('select').change(function () {
    $table.bootstrapTable('destroy').bootstrapTable({
      exportDataType: $(this).val(),
      exportTypes: ['json', 'xml', 'csv', 'txt', 'sql', 'excel', 'pdf'],
      columns: [
        {
          field: 'state',
          checkbox: true,
          visible: $(this).val() === 'selected'
        },
        {
          field: 'id',
          title: 'ID'
        }, {
          field: 'name',
          title: 'Item Name'
        }, {
          field: 'price',
          title: 'Item Price'
        }
      ]
    })
  }).trigger('change')
})


    </script>

  </body>
</html>